<div class="card bg-base-100 shadow-2xl border border-base-300 overflow-hidden">
  <div class="card-body p-6">
    
    @if (!fileName()) {
      <div 
        class="flex flex-col items-center justify-center py-12 px-6 border-2 border-dashed border-base-300 rounded-xl hover:border-primary transition-colors cursor-pointer group"
        (click)="fileInput.click()"
      >
        <div class="bg-primary/10 p-4 rounded-full group-hover:scale-110 transition-transform mb-4">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
          </svg>
        </div>
        <p class="text-lg font-medium">Click or Drag & Drop Excel file</p>
        <p class="text-xs opacity-50 mt-1">XLSX, XLS, or CSV up to 10MB</p>
        <input #fileInput type="file" class="hidden" (change)="onUpload($event)" accept=".xlsx, .xls, .csv">
      </div>
    } @else {
      <div class="flex flex-col items-center py-8 animate-in zoom-in duration-300">
        <div class="relative">
          <div class="bg-success/10 p-6 rounded-2xl mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
          </div>
          <div class="absolute -top-2 -right-2 badge badge-success p-3 border-4 border-base-100">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7" />
            </svg>
          </div>
        </div>

        <h3 class="text-xl font-bold mb-1">{{ fileName() }}</h3>
        <p class="text-sm opacity-50 mb-6">File uploaded successfully and ready to convert.</p>

        <div class="flex gap-2">
          <button (click)="resetFile()" class="btn btn-ghost btn-sm">Change File</button>
          <button class="btn btn-primary btn-sm">Start Processing</button>
        </div>
      </div>
    }
  </div>
</div>

<!-- selection buttons -->
<!-- <div class="max-w-5xl mx-auto p-8">
  <h2 class="text-2xl font-bold mb-2">Configure Import</h2>
  <p class="text-sm opacity-60 mb-8 font-serif">Select how you want to process the Excel rows.</p>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">

    <app-import-mode-card title="Insert" description="Create new records only." [active]="currentMode() === 'insert'"
      (select)="currentMode.set('insert')" />

    <app-import-mode-card title="Update" description="Modify existing records." colorClass="radio-secondary"
      [active]="currentMode() === 'update'" (select)="currentMode.set('update')" />

    <app-import-mode-card title="Upsert" description="The smart sync option." colorClass="radio-accent"
      [active]="currentMode() === 'upsert'" (select)="currentMode.set('upsert')" />

  </div>

  <div class="mt-12 flex justify-end">
    <button class="btn btn-primary btn-lg">
      Process with {{ currentMode() | uppercase }} Mode
    </button>
  </div>
</div> -->

<!-- data table -->
<div class="p-8">
  @if (tableData().length > 0) {
  <div class="mt-8 overflow-x-auto border border-base-300 rounded-box shadow-sm bg-base-100">
    <table class="table table-zebra table-sm">
      <thead>
        <tr class="bg-base-200">
          @for (header of tableHeaders(); track header) {
          <th class="text-primary">{{ header }}</th>
          }
        </tr>
      </thead>
      <tbody>
        @for (row of tableData(); track row) {
        <tr class="hover">
          @for (header of tableHeaders(); track header) {
          <td>{{ row[header] }}</td>
          }
        </tr>
        }
      </tbody>
    </table>
  </div>

  <div class="mt-2 text-xs opacity-50 text-right">
    Total Rows: {{ tableData().length }}
  </div>
  } @else {
<div class="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8 p-16">
  <div class="text-center">
    <div class="text-primary mb-2">âš¡</div>
    <h3 class="font-bold">Fast Parsing</h3>
    <p class="text-sm opacity-60">Processes 10,000+ rows instantly.</p>
  </div>
  <div class="text-center">
    <div class="text-primary mb-2">ðŸ”’</div>
    <h3 class="font-bold">Private</h3>
    <p class="text-sm opacity-60">Files never leave your computer.</p>
  </div>
  <div class="text-center">
    <div class="text-primary mb-2">ðŸŽ¨</div>
    <h3 class="font-bold">Multiple Formats</h3>
    <p class="text-sm opacity-60">PDF, CSV, JSON, and more.</p>
  </div>
</div>
}
</div>


<div class="mt-8 space-y-4">
  <div class="flex items-end gap-4">
    <div class="form-control w-full max-w-xs">
      <label class="label"><span class="label-text">Target Table Name</span></label>
      <input #tableInput type="text" placeholder="e.g. EMPLOYEES" class="input input-bordered input-sm" />
    </div>
    <button 
      (click)="onProcess(tableInput.value)" 
      class="btn btn-primary btn-sm">
      Generate SQL
    </button>
  </div>

  @if (generatedSql()) {
    <div class="relative group">
      <div class="absolute right-4 top-4 opacity-0 group-hover:opacity-100 transition-opacity">
        <button class="btn btn-xs btn-outline" (click)="copyToClipboard()">Copy SQL</button>
      </div>
      <pre class="bg-slate-900 text-green-400 p-6 rounded-xl overflow-x-auto text-xs font-mono max-h-96">
        <code>{{ generatedSql() }}</code>
      </pre>
    </div>
  }
</div>